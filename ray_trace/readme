

This code is strictly a test mule to haul around the various
functions needed for a ray trace computation.


The sample data in the math notes for an ellipsoid at the 
origin and with semi-major axi of 5, 2, 6 and an observation
plane of ( 12, 0, 0 ) will result in the following if and
only if the x' , y'  coordinates on the observation plane
are as drawn. In this case ( 1.7, -2.0 ) :


vesta$ 
vesta$ ./obs_point 

INFO : viewport O obs_origin = < +1.200000000000e+01, +0.000000000000e+00, +0.000000000000e+00 >

INFO : viewport direction obs_normal = < -1.000000000000e+00, +0.000000000000e+00, +0.000000000000e+00 >
     : viewport x_prime basis vector = < +0.000000000000e+00, +1.000000000000e+00, +0.000000000000e+00 >
     : viewport y_prime basis vector = < +0.000000000000e+00, +0.000000000000e+00, +1.000000000000e+00 >
INFO : initial x' and y' : ( +1.700000000000e+00, -2.000000000000e+00 )


INFO : L obs_point = < +1.200000000000e+01, +1.700000000000e+00, -2.000000000000e+00 >


INFO : ray_direct = < -1.000000000000e+00, +0.000000000000e+00, +0.000000000000e+00 >



---------- in icept.c we see roots ----------
     : intercept_count = 2
   0 : res[0] = ( +1.371391365010e+01, +0.000000000000e+00 )
   1 : res[1] = ( +1.028608634990e+01, -0.000000000000e+00 )
-----------------------------------------------
intercept_cnt = 2
INFO : k_val[0] = ( +1.371391365010e+01, +0.000000000000e+00 )
     : k_val[1] = ( +1.028608634990e+01, -0.000000000000e+00 )

DBUG : We have a good intercept point
INFO : H hit_point = < +1.713913650100e+00, +1.700000000000e+00, -2.000000000000e+00 >

grad :  sign = 1, 1, 1
grad :   loc = 0, 0, 0
grad :   axi = 5, 2, 5
grad : icept = 1.71391, 1.7, -2

------------------------------------------
INFO : N gradient = < +1.371130920080e-01, +8.500000000000e-01, -1.600000000000e-01 >
     : normalized = < +1.565703620202e-01, +9.706207173082e-01, -1.827050761992e-01 >

INFO : -Ri = < +1.000000000000e+00, -0.000000000000e+00, -0.000000000000e+00 >
     : dot( N, -Ri ) = +1.565703620202e-01
     : theta_i = +1.413579101663e+00
     :         = +8.099211653317e+01 degrees


INFO : -Ri X N = < +0.000000000000e+00, +1.827050761992e-01, +9.706207173082e-01 >
     : this is the plane of incidence tangent
     : T = < +0.000000000000e+00, +1.849865510272e-01, +9.827410523322e-01 >
     : Cramer's Method needed from here

Left hand 3x3 matrix is :
    +------------------------+------------------------+------------------------+
    |                        |                        |                        |
 T  |  +0.000000000000e+00   |  +1.849865510272e-01   |  +9.827410523322e-01   |
    |                        |                        |                        |
    +------------------------+------------------------+------------------------+
    |                        |                        |                        |
 N  |  +1.565703620202e-01   |  +9.706207173082e-01   |  -1.827050761992e-01   |
    |                        |                        |                        |
    +------------------------+------------------------+------------------------+
    |                        |                        |                        |
-Ri |  +1.000000000000e+00   |  +0.000000000000e+00   |  +0.000000000000e+00   |
    |                        |                        |                        |
    +------------------------+------------------------+------------------------+


DET == ( -9.876668070442e-01, +0.000000000000e+00 )

     : rh_col = +0.000000000000e+00, +1.565703620202e-01, -9.509714434737e-01
     : result col = < ( -9.50971443473725e-01, +0.00000000000000e+00 ),
                      ( +3.03940874186511e-01, +0.00000000000000e+00 ),
                      ( -5.72123998468727e-02, +0.00000000000000e+00 ) >

vesta$ 



Now with a radius 1 test sphere at the origin.

These coordinates on the observation plane are manually computed
to be sqrt( 0.5 ) distance from the centre of the sphere in the
yz-plane and thus the point of incidence results in a perfect 
pi/4 radian angle of incidence and a pi/2 angle for the reflection
vector.

vesta$ ./obs_point 

INFO : viewport O obs_origin = < +1.200000000000e+01, +0.000000000000e+00, +0.000000000000e+00 >

INFO : viewport direction obs_normal = < -1.000000000000e+00, +0.000000000000e+00, +0.000000000000e+00 >
     : viewport x_prime basis vector = < +0.000000000000e+00, +1.000000000000e+00, +0.000000000000e+00 >
     : viewport y_prime basis vector = < +0.000000000000e+00, +0.000000000000e+00, +1.000000000000e+00 >
INFO : initial x' and y' : ( +5.477225575052e-01, -4.472135955000e-01 )


INFO : L obs_point = < +1.200000000000e+01, +5.477225575052e-01, -4.472135955000e-01 >


INFO : ray_direct = < -1.000000000000e+00, +0.000000000000e+00, +0.000000000000e+00 >



---------- in icept.c we see roots ----------
     : intercept_count = 2
   0 : res[0] = ( +1.270710678119e+01, +0.000000000000e+00 )
   1 : res[1] = ( +1.129289321881e+01, -0.000000000000e+00 )
-----------------------------------------------
intercept_cnt = 2
INFO : k_val[0] = ( +1.270710678119e+01, +0.000000000000e+00 )
     : k_val[1] = ( +1.129289321881e+01, -0.000000000000e+00 )

DBUG : We have a good intercept point
INFO : H hit_point = < +7.071067811865e-01, +5.477225575052e-01, -4.472135955000e-01 >

grad :  sign = 1, 1, 1
grad :   loc = 0, 0, 0
grad :   axi = 1, 1, 1
grad : icept = 0.707107, 0.547723, -0.447214

------------------------------------------
INFO : N gradient = < +1.414213562373e+00, +1.095445115010e+00, -8.944271909999e-01 >
     : normalized = < +7.071067811865e-01, +5.477225575052e-01, -4.472135955000e-01 >

INFO : -Ri = < +1.000000000000e+00, -0.000000000000e+00, -0.000000000000e+00 >
     : dot( N, -Ri ) = +7.071067811865e-01
     : theta_i = +7.853981633974e-01
     :         = +4.500000000000e+01 degrees


INFO : -Ri X N = < +0.000000000000e+00, +4.472135955000e-01, +5.477225575052e-01 >
     : this is the plane of incidence tangent
     : T = < +0.000000000000e+00, +6.324555320337e-01, +7.745966692415e-01 >
     : Cramer's Method needed from here

Left hand 3x3 matrix is :
    +------------------------+------------------------+------------------------+
    |                        |                        |                        |
 T  |  +0.000000000000e+00   |  +6.324555320337e-01   |  +7.745966692415e-01   |
    |                        |                        |                        |
    +------------------------+------------------------+------------------------+
    |                        |                        |                        |
 N  |  +7.071067811865e-01   |  +5.477225575052e-01   |  -4.472135955000e-01   |
    |                        |                        |                        |
    +------------------------+------------------------+------------------------+
    |                        |                        |                        |
-Ri |  +1.000000000000e+00   |  +0.000000000000e+00   |  +0.000000000000e+00   |
    |                        |                        |                        |
    +------------------------+------------------------+------------------------+


DET == ( -7.071067811865e-01, +0.000000000000e+00 )

     : rh_col = +0.000000000000e+00, +7.071067811865e-01, +7.273661547325e-16
     : result col = < ( +0.00000000000000e+00, +0.00000000000000e+00 ),
                      ( +7.74596669241483e-01, +0.00000000000000e+00 ),
                      ( -6.32455532033676e-01, +0.00000000000000e+00 ) >

vesta$ 


A slight offset results in a wider angle of incidence and a
reflection vector that is well obtuse and past a 90-degree
angle heading off ... somewhere.

vesta$ ./obs_point 

INFO : viewport O obs_origin = < +1.200000000000e+01, +0.000000000000e+00, +0.000000000000e+00 >

INFO : viewport direction obs_normal = < -1.000000000000e+00, +0.000000000000e+00, +0.000000000000e+00 >
     : viewport x_prime basis vector = < +0.000000000000e+00, +1.000000000000e+00, +0.000000000000e+00 >
     : viewport y_prime basis vector = < +0.000000000000e+00, +0.000000000000e+00, +1.000000000000e+00 >
INFO : initial x' and y' : ( +6.477225575052e-01, -4.472135955000e-01 )


INFO : L obs_point = < +1.200000000000e+01, +6.477225575052e-01, -4.472135955000e-01 >


INFO : ray_direct = < -1.000000000000e+00, +0.000000000000e+00, +0.000000000000e+00 >



---------- in icept.c we see roots ----------
     : intercept_count = 2
   0 : res[0] = ( +1.261681073961e+01, +0.000000000000e+00 )
   1 : res[1] = ( +1.138318926039e+01, -0.000000000000e+00 )
-----------------------------------------------
intercept_cnt = 2
INFO : k_val[0] = ( +1.261681073961e+01, +0.000000000000e+00 )
     : k_val[1] = ( +1.138318926039e+01, -0.000000000000e+00 )

DBUG : We have a good intercept point
INFO : H hit_point = < +6.168107396106e-01, +6.477225575052e-01, -4.472135955000e-01 >

grad :  sign = 1, 1, 1
grad :   loc = 0, 0, 0
grad :   axi = 1, 1, 1
grad : icept = 0.616811, 0.647723, -0.447214

------------------------------------------
INFO : N gradient = < +1.233621479221e+00, +1.295445115010e+00, -8.944271909999e-01 >
     : normalized = < +6.168107396106e-01, +6.477225575052e-01, -4.472135955000e-01 >

INFO : -Ri = < +1.000000000000e+00, -0.000000000000e+00, -0.000000000000e+00 >
     : dot( N, -Ri ) = +6.168107396106e-01
     : theta_i = +9.061119413464e-01
     :         = +5.191639000555e+01 degrees


INFO : -Ri X N = < +0.000000000000e+00, +4.472135955000e-01, +6.477225575052e-01 >
     : this is the plane of incidence tangent
     : T = < +0.000000000000e+00, +5.681705783704e-01, +8.229108055399e-01 >
     : Cramer's Method needed from here

Left hand 3x3 matrix is :
    +------------------------+------------------------+------------------------+
    |                        |                        |                        |
 T  |  +0.000000000000e+00   |  +5.681705783704e-01   |  +8.229108055399e-01   |
    |                        |                        |                        |
    +------------------------+------------------------+------------------------+
    |                        |                        |                        |
 N  |  +6.168107396106e-01   |  +6.477225575052e-01   |  -4.472135955000e-01   |
    |                        |                        |                        |
    +------------------------+------------------------+------------------------+
    |                        |                        |                        |
-Ri |  +1.000000000000e+00   |  +0.000000000000e+00   |  +0.000000000000e+00   |
    |                        |                        |                        |
    +------------------------+------------------------+------------------------+


DET == ( -7.871114987732e-01, +0.000000000000e+00 )

     : rh_col = +0.000000000000e+00, +6.168107396106e-01, -2.390890230021e-01
     : result col = < ( -2.39089023002067e-01, +0.00000000000000e+00 ),
                      ( +7.99044459514452e-01, +0.00000000000000e+00 ),
                      ( -5.51692297208483e-01, +0.00000000000000e+00 ) >

vesta$ 

